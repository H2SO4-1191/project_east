<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ProjectEast API Docs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="color-scheme" content="dark">
  <style>
    :root {
      /* OLED Dark Palette */
      --bg-body: #000000;      /* True black for OLED */
      --bg-sidebar: #0d1117;   /* GitHub Dark Dimmed */
      --bg-card: #161b22;      /* Slightly lighter for cards */
      --bg-hover: #21262d;
      --bg-input: #0d1117;
      
      --text-main: #e6edf3;    /* High contrast white-ish */
      --text-muted: #8b949e;   /* Muted grey */
      
      --border-color: #30363d; /* Subtle dark borders */
      --primary-color: #58a6ff; /* Bright Blue for dark mode */
      
      /* Method Colors (Dark Mode Adapted) */
      /* Using RGBA for transparent backgrounds so they blend with true black */
      --color-get: #3fb950;
      --bg-get: rgba(55, 196, 75, 0.15);
      
      --color-post: #79c0ff;
      --bg-post: rgba(56, 139, 253, 0.15);
      
      --color-put: #d29922;
      --bg-put: rgba(187, 128, 9, 0.15);
      
      --color-delete: #ff7b72;
      --bg-delete: rgba(248, 81, 73, 0.15);

      --radius: 6px;
      --transition: 0.2s ease;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 0;
      background-color: var(--bg-body);
      color: var(--text-main);
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      display: flex;
      height: 100vh;
      overflow: hidden;
    }

    /* Scrollbar Styling for Webkit */
    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: var(--bg-body); }
    ::-webkit-scrollbar-thumb { background: #484f58; border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: #6e7681; }

    /* Layout */
    .sidebar {
      width: 260px;
      background-color: var(--bg-sidebar);
      border-right: 1px solid var(--border-color);
      display: flex;
      flex-direction: column;
      flex-shrink: 0;
      padding: 20px;
      overflow-y: auto;
    }

    .main {
      flex: 1;
      overflow-y: auto;
      padding: 0;
      position: relative;
    }

    .main-inner {
      max-width: 1000px;
      margin: 0 auto;
      padding: 40px;
    }

    /* Sidebar Components */
    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 20px;
      padding-bottom: 20px;
      border-bottom: 1px solid var(--border-color);
    }

    .logo-badge {
      background: var(--text-main);
      color: var(--bg-body);
      width: 36px;
      height: 36px;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }

    .logo-text-title { font-weight: 700; font-size: 16px; color: var(--text-main); }
    .logo-text-sub { font-size: 12px; color: var(--text-muted); }

    .base-url-box {
      background: var(--bg-body);
      border: 1px solid var(--border-color);
      padding: 10px;
      border-radius: var(--radius);
      font-size: 12px;
      margin-bottom: 20px;
      position: relative;
    }

    .base-url-label {
      display: block;
      color: var(--text-muted);
      font-size: 10px;
      text-transform: uppercase;
      margin-bottom: 5px;
    }

    .base-url-value {
      font-family: monospace;
      color: var(--primary-color);
      word-break: break-all;
    }

    .copy-btn {
      position: absolute;
      top: 5px;
      right: 5px;
      background: var(--bg-hover);
      color: var(--text-main);
      border: 1px solid var(--border-color);
      border-radius: 3px;
      font-size: 10px;
      padding: 2px 6px;
      cursor: pointer;
    }
    .copy-btn:hover { background: #30363d; }

    .sidebar-section-title {
      font-size: 11px;
      text-transform: uppercase;
      color: var(--text-muted);
      font-weight: 600;
      margin-top: 10px;
      margin-bottom: 10px;
    }

    .nav {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .nav-item {
      padding: 8px 10px;
      border-radius: var(--radius);
      cursor: pointer;
      font-size: 13px;
      color: var(--text-muted);
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: background var(--transition);
    }

    .nav-item:hover { background-color: var(--bg-hover); color: var(--text-main); }
    
    .nav-item.active {
      background-color: rgba(56, 139, 253, 0.15); /* Low opacity blue */
      color: var(--primary-color);
      font-weight: 500;
    }

    .nav-pill {
      background: rgba(255,255,255,0.1);
      padding: 1px 6px;
      border-radius: 10px;
      font-size: 11px;
      color: var(--text-muted);
    }
    .nav-item.active .nav-pill { background: rgba(56, 139, 253, 0.3); color: var(--primary-color); }

    .nav-footer {
      margin-top: auto;
      padding-top: 20px;
      font-size: 11px;
      color: var(--text-muted);
      border-top: 1px solid var(--border-color);
    }

    /* Header & Search */
    .page-header { margin-bottom: 30px; }
    .page-title { font-size: 28px; font-weight: 700; display: flex; align-items: center; gap: 10px; color: var(--text-main); }
    .page-title-pill { 
      font-size: 12px; 
      background: var(--bg-hover); 
      padding: 4px 8px; 
      border-radius: 100px; 
      border: 1px solid var(--border-color); 
      color: var(--text-muted); 
      font-weight: normal; 
    }
    .page-subtitle { margin-top: 8px; color: var(--text-muted); line-height: 1.5; }

    .search-wrapper { margin-bottom: 30px; }
    .search-input {
      width: 100%;
      padding: 12px 15px 12px 35px;
      border: 1px solid var(--border-color);
      border-radius: var(--radius);
      font-size: 14px;
      outline: none;
      transition: border-color var(--transition);
      background-color: var(--bg-input);
      color: var(--text-main);
      /* Inverted Search Icon for Dark Mode */
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%238b949e' viewBox='0 0 16 16'%3E%3Cpath d='M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: 10px center;
    }
    .search-input:focus { border-color: var(--primary-color); }

    /* Sections & Endpoints */
    .section { margin-bottom: 40px; scroll-margin-top: 20px; }
    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      margin-bottom: 15px;
      padding-bottom: 5px;
      border-bottom: 2px solid var(--bg-hover);
    }
    .section-title { font-size: 18px; font-weight: 700; color: var(--text-main); }
    .section-count { font-size: 12px; color: var(--text-muted); }

    /* Endpoint Card */
    .endpoint {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: var(--radius);
      margin-bottom: 12px;
      transition: box-shadow var(--transition);
    }

    .endpoint:hover {
      box-shadow: 0 4px 12px rgba(0,0,0,0.5);
      border-color: #58a6ff;
    }

    .endpoint-header {
      padding: 12px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      cursor: pointer;
      background: var(--bg-card);
      border-radius: var(--radius);
      user-select: none;
    }
    
    .endpoint.open .endpoint-header {
      border-bottom-left-radius: 0;
      border-bottom-right-radius: 0;
      background-color: var(--bg-card);
      border-bottom: 1px solid var(--border-color);
    }

    .endpoint-header-main {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
      flex: 1;
    }

    /* Methods */
    .method {
      font-size: 11px;
      font-weight: 700;
      padding: 4px 8px;
      border-radius: 4px;
      min-width: 60px;
      text-align: center;
      text-transform: uppercase;
      border: 1px solid transparent;
    }
    .method-get { background: var(--bg-get); color: var(--color-get); border-color: rgba(55, 196, 75, 0.4); }
    .method-post { background: var(--bg-post); color: var(--color-post); border-color: rgba(56, 139, 253, 0.4); }
    .method-put { background: var(--bg-put); color: var(--color-put); border-color: rgba(187, 128, 9, 0.4); }
    .method-delete { background: var(--bg-delete); color: var(--color-delete); border-color: rgba(248, 81, 73, 0.4); }

    .endpoint-url {
      font-family: monospace;
      font-size: 13px;
      color: var(--text-main);
    }

    .endpoint-usecase {
      font-size: 13px;
      color: var(--text-muted);
      margin-left: 10px;
    }

    .endpoint-labels { display: flex; gap: 8px; margin-right: 15px; }
    
    .chip {
      font-size: 11px;
      padding: 2px 8px;
      border-radius: 100px;
      border: 1px solid var(--border-color);
      background: var(--bg-body);
      color: var(--text-muted);
    }
    .chip-jwt-on { border-color: #238636; color: #3fb950; } 
    .chip-role { background: var(--bg-hover); }

    .endpoint-toggle {
      font-size: 18px;
      color: var(--text-muted);
      transform: rotate(90deg);
      transition: transform var(--transition);
    }
    .endpoint.open .endpoint-toggle { transform: rotate(270deg); color: var(--primary-color); }

    /* Endpoint Body (Expandable) */
    .endpoint-body {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease-in-out;
      background-color: var(--bg-body); /* True black for content area */
      border-top: 1px solid transparent;
    }

    .endpoint.open .endpoint-body {
      border-top-color: var(--border-color);
    }

    .endpoint-body-inner {
      padding: 20px;
      display: grid;
      grid-template-columns: 1fr 1fr; 
      gap: 20px;
    }

    @media (max-width: 900px) {
      body { flex-direction: column; height: auto; overflow: auto; }
      .sidebar { width: 100%; height: auto; border-right: none; border-bottom: 1px solid var(--border-color); }
      .endpoint-body-inner { grid-template-columns: 1fr; }
      .endpoint-usecase { display: none; }
    }

    /* Fields inside body */
    .field { margin-bottom: 15px; }
    .field-title {
      font-size: 11px;
      font-weight: 700;
      text-transform: uppercase;
      color: var(--text-muted);
      margin-bottom: 6px;
    }
    .field-content { font-size: 13px; line-height: 1.5; color: var(--text-main); }
    
    pre {
      background: #010409; /* Very dark for code blocks */
      padding: 12px;
      border-radius: 6px;
      border: 1px solid var(--border-color);
      overflow-x: auto;
      margin: 0;
      font-size: 12px;
      color: #ff7b72; /* Reddish for code text */
    }
    
    code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; }

    /* Fixed Lists / Tables */
    .fixed-section {
      background: var(--bg-card);
      border: 1px solid var(--border-color);
      border-radius: var(--radius);
      padding: 20px;
    }
    .fixed-header { margin-bottom: 15px; border-bottom: 1px solid var(--border-color); padding-bottom: 10px; }
    .fixed-title { font-weight: 700; color: var(--text-main); }
    .fixed-note { font-size: 12px; color: var(--text-muted); }
    
    .fixed-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 15px;
    }

    .fixed-card {
      background: var(--bg-body);
      border: 1px solid var(--border-color);
      padding: 10px;
      border-radius: 4px;
      font-size: 12px;
    }
    .fixed-card h4 { margin: 0 0 8px 0; font-size: 12px; color: var(--text-muted); text-transform: uppercase; }
    
    .fixed-table { width: 100%; border-collapse: collapse; }
    .fixed-table td { padding: 4px 0; border-bottom: 1px solid var(--border-color); color: var(--text-main); }
    .fixed-table td:first-child { font-family: monospace; color: var(--primary-color); padding-right: 10px; }
    .fixed-table tr:last-child td { border-bottom: none; }

    .hidden { display: none !important; }
  </style>
</head>
<body>

  <aside class="sidebar">
    <div class="logo">
      <div class="logo-badge">PE</div>
      <div>
        <div class="logo-text-title">ProjectEast</div>
        <div class="logo-text-sub">Backend API · v1</div>
      </div>
    </div>

    <div class="base-url-box">
      <span class="base-url-label">Base URL</span>
      <div class="base-url-value" id="baseUrl">https://projecteastapi.ddns.net</div>
      <button class="copy-btn" id="copyBase">copy</button>
    </div>

    <div class="sidebar-section-title">Navigation</div>
    <nav class="nav" id="nav"></nav>

    <div class="nav-footer">
      Auth Header: Bearer &lt;token&gt;
    </div>
  </aside>

  <main class="main">
    <div class="main-inner">
      <header class="page-header">
        <div class="page-title">
          API Reference
          <span class="page-title-pill">REST</span>
        </div>
        <div class="page-subtitle">
          Documentation for Project East backend endpoints.
        </div>
      </header>

      <div class="search-wrapper">
        <input id="searchInput" class="search-input" placeholder="Search endpoints (e.g. /registration, courses, jobs)..." />
      </div>

      <div id="sections"></div>

      <section class="section" id="fixed-lists">
        <div class="section-header">
          <div class="section-title">Fixed Lists &amp; Enums</div>
        </div>
        <div class="fixed-section">
          <div class="fixed-header">
            <div class="fixed-title">Reference values</div>
            <div class="fixed-note">Fixed choices stored in DB. Use these keys in API requests.</div>
          </div>
          <div class="fixed-grid">
            <div class="fixed-card">
              <h4>User Types</h4>
              <table class="fixed-table">
                <tr><td>"institution"</td><td>Institution account</td></tr>
                <tr><td>"lecturer"</td><td>Lecturer/teacher account</td></tr>
                <tr><td>"student"</td><td>Student account</td></tr>
              </table>
            </div>

            <div class="fixed-card">
              <h4>Cities</h4>
              <table class="fixed-table">
                <tr><td>"baghdad"</td><td>Baghdad</td></tr>
                <tr><td>"basra"</td><td>Basra</td></tr>
                <tr><td>"maysan"</td><td>Maysan</td></tr>
                <tr><td>"dhi_qar"</td><td>Dhi Qar</td></tr>
                <tr><td>"erbil"</td><td>Erbil</td></tr>
                <tr><td>...</td><td>(See full list in docs)</td></tr>
              </table>
            </div>

            <div class="fixed-card">
              <h4>Course Level</h4>
              <table class="fixed-table">
                <tr><td>"beginner"</td><td>Beginner</td></tr>
                <tr><td>"intermediate"</td><td>Intermediate</td></tr>
                <tr><td>"advanced"</td><td>Advanced</td></tr>
              </table>
            </div>

            <div class="fixed-card">
              <h4>Attendance Status</h4>
              <table class="fixed-table">
                <tr><td>"present"</td><td>Student attended</td></tr>
                <tr><td>"absent"</td><td>Student absent</td></tr>
                <tr><td>"late"</td><td>Student late</td></tr>
              </table>
            </div>
          </div>
        </div>
      </section>
    </div>
  </main>

  <script>
    const BASE_URL = "https://projecteastapi.ddns.net";

    // === Endpoint data ===
    const endpoints = [
      /* GLOBAL / PUBLIC / UTIL */
      {
        section: "Global & Utility",
        name: "Home Feed",
        method: "GET",
        path: "/home/feed/",
        usecase: "Get mixed feed of posts, courses and jobs.",
        permission: "Public. Personalized if JWT sent.",
        jwt: "Optional",
        requestBody: null,
        successExample: `GET ${BASE_URL}/home/feed/

Response 200:
{
  "count": 20,
  "results": [
    {
      "type": "post",
      "id": 1,
      "title": "New course",
      "description": "Details...",
      "created_at": "2025-01-01T10:00:00Z"
    }
  ]
}`,
        errorsExample: `401 if provided JWT is invalid.`
      },
      {
        section: "Global & Utility",
        name: "Document Type Check (AI)",
        method: "POST",
        path: "/ai/doc/",
        usecase: "Upload file to check if it is a document.",
        permission: "Authenticated only.",
        jwt: "Required",
        requestBody: `Content-Type: multipart/form-data
file: <uploaded file>`,
        successExample: `{
  "document_percentage": 92.31,
  "is_document": true
}`,
        errorsExample: `400: "No file uploaded"`
      },
      {
        section: "Global & Utility",
        name: "Notifications",
        method: "GET",
        path: "/notifications/",
        usecase: "Get reminders about tomorrow's lectures.",
        permission: "Authenticated (student/lecturer).",
        jwt: "Required",
        requestBody: null,
        successExample: `{
  "success": true,
  "notifications": [
    {
      "type": "lecture_reminder",
      "course_title": "Physics 101",
      "time": "09:00"
    }
  ]
}`,
        errorsExample: `401 if invalid JWT.`
      },
      {
        section: "Global & Utility",
        name: "Course Progress",
        method: "GET",
        path: "/course/<course_id>/progress/",
        usecase: "Get student progress or overall avg.",
        permission: "Public.",
        jwt: "Optional",
        requestBody: null,
        successExample: `{
  "success": true,
  "progress": {
    "course_title": "Python Basics",
    "completed_lectures": 7,
    "progress_percentage": 70.0
  }
}`,
        errorsExample: `404: "Course not found."`
      },
      {
        section: "Global & Utility",
        name: "Explore Search",
        method: "GET",
        path: "/explore/",
        usecase: "Full-text search.",
        permission: "Public.",
        jwt: "Optional",
        requestBody: `Query params:
q = search term
filter = "students"|"lecturers"|"courses"|"jobs"`,
        successExample: `GET /explore/?q=python

{
  "success": true,
  "courses": [ ... ]
}`,
        errorsExample: `400: "Invalid filter."`
      },

      /* AUTH */
      {
        section: "Auth & Registration",
        name: "Signup",
        method: "POST",
        path: "/registration/signup/",
        usecase: "Register user. Sends OTP.",
        permission: "Public.",
        jwt: "No",
        requestBody: `{
  "username": "myuser",
  "email": "user@example.com",
  "first_name": "John",
  "last_name": "Doe",
  "city": "baghdad",
  "user_type": "student"
}`,
        successExample: `201: { "success": true, "message": "Account registered." }`,
        errorsExample: `400: { "email": ["Already exists"] }`
      },
      {
        section: "Auth & Registration",
        name: "Login",
        method: "POST",
        path: "/registration/login/",
        usecase: "Request Login OTP.",
        permission: "Public.",
        jwt: "No",
        requestBody: `{ "email": "user@example.com" }`,
        successExample: `200: { "message": "OTP sent." }`,
        errorsExample: `400: { "email": ["Not found"] }`
      },
      {
        section: "Auth & Registration",
        name: "OTP Verify",
        method: "POST",
        path: "/registration/otp/",
        usecase: "Verify OTP, get Tokens.",
        permission: "Public.",
        jwt: "No",
        requestBody: `{ "email": "...", "otp_code": "123456" }`,
        successExample: `{
  "access": "<token>",
  "refresh": "<token>",
  "user_type": "student"
}`,
        errorsExample: `400: "Invalid OTP code"`
      },

      /* INSTITUTION */
      {
        section: "Institution Dashboard",
        name: "Total Students",
        method: "GET",
        path: "/institution/total-students/",
        usecase: "Count linked students.",
        permission: "Institution.",
        jwt: "Required",
        requestBody: null,
        successExample: `{ "total_students": 42 }`,
        errorsExample: `403 if not institution.`
      },
      {
        section: "Institution Dashboard",
        name: "Students List",
        method: "GET",
        path: "/institution/students-list/",
        usecase: "Paginated list.",
        permission: "Institution.",
        jwt: "Required",
        requestBody: `Query: active=true|false`,
        successExample: `{ "results": [ { "first_name": "Ali", ... } ] }`,
        errorsExample: `403`
      },
      {
        section: "Institution Management",
        name: "Verify Account",
        method: "PUT",
        path: "/institution/verify/",
        usecase: "Submit docs for verification.",
        permission: "Institution.",
        jwt: "Required",
        requestBody: `Multipart: title, location, phone, idcard images...`,
        successExample: `{ "is_verified": true }`,
        errorsExample: `400: Missing fields.`
      },
      {
        section: "Institution Management",
        name: "Create Course",
        method: "POST",
        path: "/institution/create-course/",
        usecase: "Create new course.",
        permission: "Institution Verified.",
        jwt: "Required",
        requestBody: `JSON/Multipart: title, dates, price, schedule days...`,
        successExample: `{ "course_id": 12 }`,
        errorsExample: `400: Validation error.`
      },
      {
        section: "Institution Management",
        name: "Create Staff",
        method: "POST",
        path: "/institution/staff/create/",
        usecase: "Add staff member.",
        permission: "Institution.",
        jwt: "Required",
        requestBody: `Multipart: name, phone, duty, salary...`,
        successExample: `{ "staff_id": 2 }`,
        errorsExample: `400`
      },
      {
        section: "Institution Jobs",
        name: "Create Job",
        method: "POST",
        path: "/institution/job/create/",
        usecase: "Post a job for lecturers.",
        permission: "Institution Verified.",
        jwt: "Required",
        requestBody: `{ "title": "Math Teacher", "salary_offer": 500000 }`,
        successExample: `{ "job_id": 9 }`,
        errorsExample: `400`
      },

      /* LECTURER */
      {
        section: "Lecturer Area",
        name: "Self Profile",
        method: "GET",
        path: "/lecturer/profile/self/",
        usecase: "Get own profile data.",
        permission: "Lecturer.",
        jwt: "Required",
        requestBody: null,
        successExample: `{ "data": { "specialty": "Math", ... } }`,
        errorsExample: `403`
      },
      {
        section: "Lecturer Area",
        name: "Edit Profile",
        method: "PUT",
        path: "/lecturer/profile/edit/",
        usecase: "Update details.",
        permission: "Lecturer.",
        jwt: "Required",
        requestBody: `Partial: specialty, free_time, bio...`,
        successExample: `{ "success": true }`,
        errorsExample: `400`
      },
      {
        section: "Lecturer Tools",
        name: "Create Exam",
        method: "POST",
        path: "/lecturer/course/<id>/exam/create/",
        usecase: "Add exam to course.",
        permission: "Lecturer Verified.",
        jwt: "Required",
        requestBody: `{ "title": "Midterm", "max_score": 100 }`,
        successExample: `{ "exam_id": 3 }`,
        errorsExample: `404 Course not found`
      },
      {
        section: "Lecturer Tools",
        name: "Submit Grades",
        method: "POST",
        path: "/lecturer/exam/<id>/grades/",
        usecase: "Bulk add grades & email students.",
        permission: "Lecturer Verified.",
        jwt: "Required",
        requestBody: `{ "grades": [ {"student_id": 5, "score": 90} ] }`,
        successExample: `{ "message": "Grades processed." }`,
        errorsExample: `400`
      },
      {
        section: "Lecturer Tools",
        name: "Mark Attendance",
        method: "POST",
        path: "/lecturer/course/<id>/attendance/",
        usecase: "Bulk attendance for a lecture.",
        permission: "Lecturer Verified.",
        jwt: "Required",
        requestBody: `{ "lecture_number": 1, "records": [...] }`,
        successExample: `{ "success": true }`,
        errorsExample: `400`
      },

      /* STUDENT */
      {
        section: "Student Area",
        name: "Self Profile",
        method: "GET",
        path: "/student/profile/self/",
        usecase: "Get own profile.",
        permission: "Student.",
        jwt: "Required",
        requestBody: null,
        successExample: `{ "data": { "studying_level": "bachelors" } }`,
        errorsExample: `403`
      },
      {
        section: "Student Area",
        name: "My Schedule",
        method: "GET",
        path: "/student/schedule/",
        usecase: "Weekly course schedule.",
        permission: "Student Verified.",
        jwt: "Required",
        requestBody: null,
        successExample: `{ "schedule": [ { "day": "monday", "course": "Math" } ] }`,
        errorsExample: `401`
      },
      {
        section: "Student Area",
        name: "My Grades",
        method: "GET",
        path: "/student/course/<id>/grades/",
        usecase: "View grades in specific course.",
        permission: "Student Verified.",
        jwt: "Required",
        requestBody: null,
        successExample: `{ "grades": [ { "exam": "Midterm", "score": 85 } ] }`,
        errorsExample: `404`
      },

      /* PUBLIC DETAILS */
      {
        section: "Public Details",
        name: "Course Detail",
        method: "GET",
        path: "/course/<course_id>/",
        usecase: "Get full course info (price, dates).",
        permission: "Public.",
        jwt: "No",
        requestBody: null,
        successExample: `{ "data": { "title": "Python", "price": "150.00" } }`,
        errorsExample: `404`
      }
    ];

    // === RENDER LOGIC ===
    const navEl = document.getElementById("nav");
    const sectionsEl = document.getElementById("sections");
    const searchInput = document.getElementById("searchInput");

    function groupBySection(list) {
      const groups = {};
      for (const ep of list) {
        if (!groups[ep.section]) groups[ep.section] = [];
        groups[ep.section].push(ep);
      }
      return groups;
    }

    function sectionId(name) {
      return "sec-" + name.toLowerCase().replace(/[^a-z0-9]+/g, "-");
    }

    function renderNav(sections) {
      navEl.innerHTML = "";
      const sectionNames = Object.keys(sections);
      sectionNames.forEach((name, idx) => {
        const item = document.createElement("div");
        item.className = "nav-item" + (idx === 0 ? " active" : "");
        
        const spanTitle = document.createElement("span");
        spanTitle.textContent = name;

        const pill = document.createElement("span");
        pill.className = "nav-pill";
        pill.textContent = sections[name].length;

        item.appendChild(spanTitle);
        item.appendChild(pill);

        item.addEventListener("click", () => {
          document.querySelectorAll(".nav-item").forEach(n => n.classList.remove("active"));
          item.classList.add("active");
          const target = document.getElementById(sectionId(name));
          if(target) target.scrollIntoView({ behavior: "smooth", block: "start" });
        });

        navEl.appendChild(item);
      });
    }

    function renderSections(groups) {
      sectionsEl.innerHTML = "";
      Object.entries(groups).forEach(([name, list]) => {
        const section = document.createElement("section");
        section.className = "section";
        section.id = sectionId(name);

        const header = document.createElement("div");
        header.className = "section-header";
        
        const title = document.createElement("div");
        title.className = "section-title";
        title.textContent = name;
        
        const count = document.createElement("div");
        count.className = "section-count";
        count.textContent = list.length + " endpoints";

        header.appendChild(title);
        header.appendChild(count);
        section.appendChild(header);

        list.forEach(ep => {
          section.appendChild(renderEndpoint(ep));
        });

        sectionsEl.appendChild(section);
      });
    }

    function renderEndpoint(ep) {
      const card = document.createElement("article");
      // Default state: collapsed.
      card.className = "endpoint"; 

      const header = document.createElement("div");
      header.className = "endpoint-header";

      const headerMain = document.createElement("div");
      headerMain.className = "endpoint-header-main";

      const method = document.createElement("span");
      method.className = "method " + methodClass(ep.method);
      method.textContent = ep.method;

      const url = document.createElement("span");
      url.className = "endpoint-url";
      url.textContent = ep.path;
      
      const usecase = document.createElement("span");
      usecase.className = "endpoint-usecase";
      usecase.textContent = ep.usecase;

      headerMain.appendChild(method);
      headerMain.appendChild(url);
      headerMain.appendChild(usecase);

      const labels = document.createElement("div");
      labels.className = "endpoint-labels";

      if (ep.permission && !ep.permission.toLowerCase().includes("public")) {
        const chipRole = document.createElement("span");
        chipRole.className = "chip chip-role";
        chipRole.textContent = roleShort(ep.permission);
        labels.appendChild(chipRole);
      }

      const chipJwt = document.createElement("span");
      chipJwt.className = "chip " + (ep.jwt === "Required" ? "chip-jwt-on" : "");
      chipJwt.textContent = ep.jwt === "Required" ? "JWT" : "Public";
      labels.appendChild(chipJwt);

      const toggle = document.createElement("div");
      toggle.className = "endpoint-toggle";
      toggle.textContent = "›";

      header.appendChild(headerMain);
      header.appendChild(labels);
      header.appendChild(toggle);

      const body = document.createElement("div");
      body.className = "endpoint-body";

      const bodyInner = document.createElement("div");
      bodyInner.className = "endpoint-body-inner";

      const col1 = document.createElement("div");
      col1.appendChild(fieldBlock("Description / Permission", `${ep.usecase}\n${ep.permission || ''}`));
      
      if (ep.requestBody !== null) {
        col1.appendChild(fieldCode("Request Body", ep.requestBody));
      } else {
        col1.appendChild(fieldBlock("Request Body", "No body required."));
      }

      const col2 = document.createElement("div");
      col2.appendChild(fieldCode("Success Response", ep.successExample || "N/A"));
      col2.appendChild(fieldCode("Error Response", ep.errorsExample || "N/A"));

      bodyInner.appendChild(col1);
      bodyInner.appendChild(col2);
      body.appendChild(bodyInner);

      header.addEventListener("click", () => {
        const isOpen = card.classList.contains("open");
        if (isOpen) {
          card.classList.remove("open");
          body.style.maxHeight = "0";
        } else {
          card.classList.add("open");
          body.style.maxHeight = bodyInner.scrollHeight + 50 + "px";
        }
      });

      card.appendChild(header);
      card.appendChild(body);
      return card;
    }

    function methodClass(m) {
      const x = m.toUpperCase();
      if (x === "GET") return "method-get";
      if (x === "POST") return "method-post";
      if (x.includes("PUT")) return "method-put";
      if (x === "DELETE") return "method-delete";
      return "";
    }

    function roleShort(p) {
      if(!p) return "";
      if(p.toLowerCase().includes("institution")) return "Inst.";
      if(p.toLowerCase().includes("lecturer")) return "Lect.";
      if(p.toLowerCase().includes("student")) return "Stud.";
      return "Auth";
    }

    function fieldBlock(title, text) {
      const div = document.createElement("div");
      div.className = "field";
      const t = document.createElement("div");
      t.className = "field-title";
      t.textContent = title;
      const c = document.createElement("div");
      c.className = "field-content";
      c.textContent = text;
      div.appendChild(t);
      div.appendChild(c);
      return div;
    }

    function fieldCode(title, text) {
      const div = document.createElement("div");
      div.className = "field";
      const t = document.createElement("div");
      t.className = "field-title";
      t.textContent = title;
      const pre = document.createElement("pre");
      const code = document.createElement("code");
      code.textContent = text;
      pre.appendChild(code);
      div.appendChild(t);
      div.appendChild(pre);
      return div;
    }

    searchInput.addEventListener("input", (e) => {
      const term = e.target.value.toLowerCase();
      document.querySelectorAll(".endpoint").forEach(card => {
        const text = card.innerText.toLowerCase();
        if(text.includes(term)) {
          card.classList.remove("hidden");
        } else {
          card.classList.add("hidden");
        }
      });
    });

    document.getElementById("copyBase").addEventListener("click", function() {
      const url = document.getElementById("baseUrl").innerText;
      navigator.clipboard.writeText(url).then(() => {
        const original = this.innerText;
        this.innerText = "Copied!";
        setTimeout(() => this.innerText = original, 1000);
      });
    });

    const groups = groupBySection(endpoints);
    renderNav(groups);
    renderSections(groups);

    const first = document.querySelector(".endpoint-header");
    if(first) first.click();

  </script>
</body>
</html>